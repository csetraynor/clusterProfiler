library(DOSE)
geneID
data(geneID)
data("geneID")
DOSE::geneID
data(DOSE::geneID)
DOSE::geneID()
?geneID
data("geneList")
de <- names(geneList)[1:100]
x <- enrichDO(de)
x
geneID(x)
devtools::document()
source("https://bioconductor.org/biocLite.R")
biocLite("DOSE")
devtools::install_github("GuangchuangYu/DOSE")
devtools::install_github("GuangchuangYu/enrichplot")
install.packages("igraph")
install.packages("igraph")
q()
devtools::install_github("GuangchuangYu/enrichplot")
devtools::document()
library(glmnet)
cvfit <- readRDS("C:/RFactory/predsurv/performance_results/enet_model_iclust2_filter.RDS")
genedata <- readr::read_tsv("C:/RFactory/Downloads/brca_metabric/data_expression.txt", col_names = TRUE)
genedata$Entrez_Gene_Id[match(names(geneList), genedata$Hugo_Symbol)]
if("age_std" %in% optimal$Hugo_Symbol){
geneTable <- optimal[(-match(c("age_std", "npi"),optimal$Hugo_Symbol)),]
}else{
geneTable <- optimal
}
geneList <- geneTable$mod
names(geneList) <- geneTable$Hugo_Symbol
brca <- readRDS("C:/RFactory/Rdata_brca/brca_data.RDS")
cvfit <- readRDS("C:/RFactory/predsurv/performance_results/ridge2_model_brca_pooled.RDS")
iclust2 <- brca[brca$intclust == 2, ]
#rm(brca)
library(glmnet)
library(dplyr)
optimal <- as.matrix(coef(cvfit, s = "lambda.min"))
optimal <- as.data.frame(optimal)
colnames(optimal) <- "mod"
optimal$Hugo_Symbol <- rownames(optimal)
optimal <- optimal %>% filter(mod!=0)
genedata$Entrez_Gene_Id[match(names(geneList), genedata$Hugo_Symbol)]
if("age_std" %in% optimal$Hugo_Symbol){
geneTable <- optimal[(-match(c("age_std", "npi"),optimal$Hugo_Symbol)),]
}else{
geneTable <- optimal
}
geneList <- geneTable$mod
genedata$Entrez_Gene_Id[match(names(geneList), genedata$Hugo_Symbol)]
names(geneList) <- geneTable$Hugo_Symbol
gene <- genedata$Entrez_Gene_Id[match(names(geneList)[abs(geneList)>quantile(abs(optimal$mod),.5)], genedata$Hugo_Symbol)]
gene.df <- clusterProfiler::bitr(gene, fromType = "ENTREZID",
toType = c("ENSEMBL", "SYMBOL"),
OrgDb = org.Hs.eg.db)
devtools::document()
gene.df <- clusterProfiler::bitr(gene, fromType = "ENTREZID",
toType = c("ENSEMBL", "SYMBOL"),
OrgDb = org.Hs.eg.db)
library(AnnotationHub)
# !diagnostics off
library(qusage)
library(AnnotationHub)
library(glmnet)
library(dplyr)
gene.df <- clusterProfiler::bitr(gene, fromType = "ENTREZID",
toType = c("ENSEMBL", "SYMBOL"),
OrgDb = org.Hs.eg.db)
library(org.Hs.eg.db)
gene.df <- clusterProfiler::bitr(gene, fromType = "ENTREZID",
toType = c("ENSEMBL", "SYMBOL"),
OrgDb = org.Hs.eg.db)
gene.df
head(gene.df)
ego <- enrichGO(gene          = gene,
universe      = names(geneList),
OrgDb         = org.Hs.eg.db,
ont           = "CC",
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05)
ego <- enrichGO(gene          = gene,
universe      = names(geneList),
OrgDb         = org.Hs.eg.db,
ont           = "CC",
pAdjustMethod = "BH",
pvalueCutoff  = 0.1,
qvalueCutoff  = 0.1)
names(geneList) <- genedata$Entrez_Gene_Id[match(names(geneList), genedata$Hugo_Symbol)]
ncg <- gseNCG(sort(geneList, decreasing = TRUE),
nPerm         = 10,
minGSSize     =  2,
maxGSSize =  100,
pvalueCutoff  = 1,
pAdjustMethod = "BH",
verbose       = TRUE)
?gseNCG
library(DOSE)
ncg <- gseNCG(sort(geneList, decreasing = TRUE),
nPerm         = 10,
minGSSize     =  2,
maxGSSize =  100,
pvalueCutoff  = 1,
pAdjustMethod = "BH",
verbose       = TRUE)
ncg <- setReadable(ncg, 'org.Hs.eg.db')
head(ncg, 3)
dotplot(ncg, showCategory=30)
enrichMap(ncg, vertex.label.cex=1.2, layout=igraph::layout.kamada.kawai)
emapplot(ncg, vertex.label.cex=1.2, layout=igraph::layout.kamada.kawai)
cnetplot(ncg, foldChange=geneList)
